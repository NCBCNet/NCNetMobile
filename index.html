<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>NCNetMobile - æ‰‹æœºç«¯é…ç½®å·¥å…·</title>
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/vant/4.8.1/index.css" crossorigin="anonymous">
  <script src="https://cdn.bootcdn.net/ajax/libs/vue/3.4.21/vue.global.prod.js" crossorigin="anonymous"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/vant/4.8.1/index.umd.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/codemirror/5.65.16/codemirror.min.css" crossorigin="anonymous">
  <script src="https://cdn.bootcdn.net/ajax/libs/codemirror/5.65.16/codemirror.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/codemirror/5.65.16/mode/xml/xml.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/codemirror/5.65.16/mode/clike/clike.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" crossorigin="anonymous"></script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; transition: all 0.2s ease; }
    body { 
      padding: 16px; 
      background-color: #f5f5f5; 
      max-width: 600px; 
      margin: 0 auto; 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      padding-bottom: constant(safe-area-inset-bottom);
      padding-bottom: env(safe-area-inset-bottom);
    }

    .config-box, .preview-box, .code-box { 
      background: #fff; 
      border-radius: 12px; 
      padding: 16px; 
      margin-bottom: 16px; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.08); 
    }

    h3 { 
      margin-bottom: 16px; 
      font-size: 18px; 
      color: #333; 
      font-weight: 600; 
    }

    .van-cell { margin-bottom: 8px; }
    .van-field__control { font-size: 14px !important; }

    .preview-demo { 
      padding: 24px; 
      text-align: center; 
      border: 1px solid #f0f0f0; 
      border-radius: 8px; 
      margin-top: 12px; 
      background: #fafafa;
    }
    .preview-demo h4 { 
      margin-bottom: 24px; 
      font-size: 18px; 
      color: #222; 
      font-weight: 600; 
    }
    .preview-demo button { 
      padding: 12px 32px; 
      border: none; 
      border-radius: 24px; 
      cursor: pointer; 
      font-size: 16px; 
      font-weight: 500; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .preview-demo button:active { transform: scale(0.98); }

    #code-editor { 
      height: 350px; 
      border-radius: 8px; 
      border: 1px solid #f0f0f0 !important; 
      font-size: 13px !important; 
    }

    .btn-group { 
      margin-top: 16px; 
      display: flex; 
      gap: 12px; 
      flex-wrap: wrap; 
    }
    .van-button { 
      flex: 1; 
      min-width: 120px; 
      border-radius: 8px !important; 
      font-size: 14px !important; 
      padding: 10px 0 !important; 
    }

    .code-type { 
      margin-bottom: 12px; 
      display: flex; 
      gap: 16px; 
      align-items: center; 
    }
    .van-radio { font-size: 14px !important; }

    .error-tip { 
      color: #ff4d4f; 
      font-size: 12px; 
      margin-top: 4px; 
      text-align: right; 
    }

    .loading { 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      background: rgba(255,255,255,0.8); 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      z-index: 9999; 
      font-size: 14px; 
      color: #333;
    }

    @media (max-width: 375px) {
      body { padding: 12px 8px; }
      .config-box, .preview-box, .code-box { padding: 12px; margin-bottom: 12px; }
      .preview-demo { padding: 20px 16px; }
      .preview-demo button { padding: 10px 24px; font-size: 15px; }
      #code-editor { height: 300px; }
      .van-button { min-width: 100px; }
    }

    @media (min-width: 428px) {
      .config-box, .preview-box, .code-box { padding: 20px; }
      #code-editor { height: 400px; }
    }
  </style>
</head>
<body>
  <div class="loading" id="loading">åŠ è½½ä¸­... è¯·ç¨å€™</div>

  <div id="app" style="display: none;">
    <div class="config-box">
      <h3>é…ç½®BaseViewç•Œé¢</h3>
      <van-cell-group>
        <van-field 
          v-model="config.pageTitle" 
          label="é¡µé¢æ ‡é¢˜" 
          placeholder="å¦‚ï¼šæˆ‘çš„NCNetåº”ç”¨" 
          clearable 
        />
        <van-field 
          v-model="config.btnText" 
          label="æŒ‰é’®æ–‡å­—" 
          placeholder="å¦‚ï¼šæäº¤æ•°æ®" 
          clearable 
        />
        <van-field 
          v-model="config.btnBgColor" 
          label="æŒ‰é’®èƒŒæ™¯è‰²" 
          placeholder="16è¿›åˆ¶å¦‚ï¼š#1677ff" 
          clearable 
          @input="checkColor('bg')"
        />
        <div v-if="bgColorError" class="error-tip">âŒ è¯·è¾“å…¥åˆæ³•çš„16è¿›åˆ¶é¢œè‰²ï¼ˆå¦‚#1677ffæˆ–#fffï¼‰</div>
        
        <van-field 
          v-model="config.btnTextColor" 
          label="æŒ‰é’®æ–‡å­—è‰²" 
          placeholder="16è¿›åˆ¶å¦‚ï¼š#ffffff" 
          clearable 
          @input="checkColor('text')"
        />
        <div v-if="textColorError" class="error-tip">âŒ è¯·è¾“å…¥åˆæ³•çš„16è¿›åˆ¶é¢œè‰²ï¼ˆå¦‚#ffffffæˆ–#fffï¼‰</div>
      </van-cell-group>
    </div>

    <div class="preview-box">
      <h3>å®æ—¶é¢„è§ˆï¼ˆæ‰‹æœºç«¯æ•ˆæœï¼‰</h3>
      <div class="preview-demo">
        <h4>{{config.pageTitle || 'æˆ‘çš„NCNetåº”ç”¨'}}</h4>
        <button :style="{
          background: isValidColor(config.btnBgColor) ? config.btnBgColor : '#1677ff',
          color: isValidColor(config.btnTextColor) ? config.btnTextColor : '#ffffff'
        }">
          {{config.btnText || 'æäº¤æ•°æ®'}}
        </button>
      </div>
    </div>

    <div class="code-box">
      <h3>ç”ŸæˆBaseViewä»£ç ï¼ˆç›´æ¥å¯¼å…¥Android Studioï¼‰</h3>
      <div class="code-type">
        <van-radio-group v-model="codeType">
          <van-radio name="java">Javaä»£ç </van-radio>
          <van-radio name="kotlin">Kotlinä»£ç ï¼ˆæ¨èï¼‰</van-radio>
        </van-radio-group>
      </div>
      <textarea id="code-content" v-model="codeContent" style="display: none; white-space: pre-wrap;"></textarea>
      <div id="code-editor"></div>
      <div class="btn-group">
        <van-button type="primary" @click="generateCode">ä¸€é”®ç”Ÿæˆä»£ç </van-button>
        <van-button type="success" data-clipboard-target="#code-content" id="copy-btn">ä¸€é”®å¤åˆ¶ä»£ç </van-button>
      </div>
      <div style="margin-top: 8px; font-size: 12px; color: #666;">
        âš ï¸ ä»£ç åŒ…åå·²è‡ªåŠ¨å¡«å……ï¼š<span style="color: #1677ff; font-weight: 500;">{{packageName}}</span>ï¼ˆä¸ä½ çš„Androidé¡¹ç›®ä¸€è‡´ï¼‰
      </div>
    </div>
  </div>

  <script>
    window.onload = function() {
      const { Field, CellGroup, Button, Toast, RadioGroup, Radio } = vant;
      const { createApp } = Vue;

      const app = createApp({
        data() {
          return {
            config: { 
              pageTitle: "æˆ‘çš„NCNetåº”ç”¨", 
              btnText: "æäº¤æ•°æ®", 
              btnBgColor: "#1677ff", 
              btnTextColor: "#ffffff" 
            },
            codeContent: "",
            codeEditor: null,
            codeType: "kotlin",
            packageName: "com.ncnetmobile",
            bgColorError: false,
            textColorError: false
          };
        },
        mounted() {
          document.getElementById("loading").style.display = "none";
          document.getElementById("app").style.display = "block";

          const initMode = this.codeType === "java" ? "text/x-java" : "text/x-kotlin";
          this.codeEditor = CodeMirror(document.getElementById("code-editor"), {
            lineNumbers: true,
            mode: initMode,
            theme: "default",
            readOnly: false,
            height: "350px",
            tabSize: 4,
            indentUnit: 4,
            lineWrapping: true
          });

          new ClipboardJS('#copy-btn').on('success', () => {
            Toast.success('âœ… ä»£ç å¤åˆ¶æˆåŠŸï¼å¯ç›´æ¥å¯¼å…¥Android Studio', { duration: 2000 });
          }).on('error', () => {
            Toast.fail('âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶', { duration: 2000 });
          });

          this.generateCode();

          this.$watch('codeType', () => {
            this.codeEditor.setOption("mode", this.codeType === "java" ? "text/x-java" : "text/x-kotlin");
            this.generateCode();
            Toast.info(`å·²åˆ‡æ¢åˆ°${this.codeType === "java" ? "Java" : "Kotlin"}ä»£ç `, { duration: 1500 });
          });
        },
        methods: {
          isValidColor(hex) {
            if (!hex) return false;
            const reg = /^#?([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})$/;
            return reg.test(hex);
          },

          checkColor(type) {
            const value = type === 'bg' ? this.config.btnBgColor : this.config.btnTextColor;
            const isError = !this.isValidColor(value);
            this[type + 'ColorError'] = isError;
            if (isError) {
              if (type === 'bg') this.config.btnBgColor = "#1677ff";
              if (type === 'text') this.config.btnTextColor = "#ffffff";
              Toast.warning('é¢œè‰²æ ¼å¼é”™è¯¯ï¼Œå·²è‡ªåŠ¨æ¢å¤é»˜è®¤è‰²', { duration: 1500 });
            }
          },

          hexToAndroidColor(hex) {
            if (!this.isValidColor(hex)) hex = "#1677ff";
            if (!hex.startsWith('#')) hex = '#' + hex;
            let color = hex.replace('#', '');
            if (color.length === 3) color = color.split('').map(c => c + c).join('');
            if (color.length === 6) color = 'FF' + color;
            return `0x${color.toUpperCase()}`;
          },

          generateCode() {
            const { pageTitle, btnText, btnBgColor, btnTextColor } = this.config;
            const validBgColor = this.isValidColor(btnBgColor) ? btnBgColor : "#1677ff";
            const validTextColor = this.isValidColor(btnTextColor) ? btnTextColor : "#ffffff";

            const xmlCode = `<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    android:padding="20dp">

    <TextView
        android:id="@+id/tv_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="${pageTitle}"
        android:textSize="18sp"
        android:textStyle="bold"
        android:marginBottom="30dp"
        android:textColor="#222222"/>

    <Button
        android:id="@+id/btn_submit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="${btnText}"
        android:backgroundTint="${validBgColor}"
        android:textColor="${validTextColor}"
        android:padding="12dp 32dp"
        android:textSize="16sp"/>

</LinearLayout>`;

            const javaCode = `package ${this.packageName};

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;
import androidx.appcompat.app.AppCompatActivity;

public class BaseView extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_baseview);

        TextView tvTitle = findViewById(R.id.tv_title);
        Button btnSubmit = findViewById(R.id.btn_submit);

        btnSubmit.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Toast.makeText(BaseView.this, "${btnText}ç‚¹å‡»æˆåŠŸï¼BaseViewå·²ç”Ÿæ•ˆ", Toast.LENGTH_SHORT).show();
            }
        });
    }
}`;

            const kotlinCode = `package ${this.packageName}

import android.os.Bundle
import android.widget.Toast
import androidx.appcompat.app.AppCompatActivity
import kotlinx.android.synthetic.main.activity_baseview.btn_submit
import kotlinx.android.synthetic.main.activity_baseview.tv_title

class BaseView : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_baseview)

        btn_submit.setOnClickListener {
            Toast.makeText(this, "${btnText}ç‚¹å‡»æˆåŠŸï¼BaseViewå·²ç”Ÿæ•ˆ", Toast.LENGTH_SHORT).show()
        }
    }
}`;

            const finalCode = `=============================================================
ğŸ“Œ XMLå¸ƒå±€æ–‡ä»¶ï¼ˆè·¯å¾„ï¼šres/layout/activity_baseview.xmlï¼‰
=============================================================
${xmlCode}

=============================================================
ğŸ“Œ ${this.codeType === "java" ? "Java" : "Kotlin"}ä»£ç æ–‡ä»¶ï¼ˆè·¯å¾„ï¼š${this.packageName.replace('.', '/')}/BaseView.${this.codeType}ï¼‰
=============================================================
${this.codeType === "java" ? javaCode : kotlinCode}

=============================================================
ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š
1. å¤åˆ¶XMLä»£ç  â†’ æ›¿æ¢Androidé¡¹ç›®ä¸­ res/layout/activity_baseview.xml
2. å¤åˆ¶${this.codeType === "java" ? "Java" : "Kotlin"}ä»£ç  â†’ æ›¿æ¢é¡¹ç›®ä¸­åŒåæ–‡ä»¶
3. åŒæ­¥Gradle â†’ è¿è¡ŒAPPå³å¯çœ‹åˆ°æ•ˆæœ
=============================================================`;

            this.codeContent = finalCode;
            this.codeEditor.setValue(finalCode);
          }
        }
      });

      app.use(Field).use(CellGroup).use(Button).use(Toast).use(RadioGroup).use(Radio);
      app.mount('#app');
    };

    window.addEventListener('error', function(e) {
      if (e.target.tagName === 'SCRIPT' || e.target.tagName === 'LINK') {
        document.getElementById("loading").innerText = "âš ï¸ èµ„æºåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œååˆ·æ–°é¡µé¢";
      }
    }, true);
  </script>
</body>
</html>
