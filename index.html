<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>NCNetMobile图形化配置工具</title>
  
  <!-- 引入UI组件库样式 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@4/lib/index.css">
  <!-- Vue3核心库（页面交互基础） -->
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <!-- Vant UI组件（按钮/输入框等） -->
  <script src="https://cdn.jsdelivr.net/npm/vant@4/lib/index.umd.js"></script>
  <!-- 代码编辑器样式+核心 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/codemirror@5/lib/codemirror.css">
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5/lib/codemirror.js"></script>
  <!-- 代码高亮：XML(布局)/Java/Kotlin -->
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5/mode/xml/xml.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/codemirror@5/mode/clike/clike.js"></script>
  <!-- 剪贴板插件（一键复制代码） -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>

  <style>
    /* 全局样式重置 */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    /* 页面基础布局：居中+适配手机 */
    body { padding: 16px; background-color: #f5f5f5; max-width: 600px; margin: 0 auto; }
    /* 配置/预览/代码区通用样式 */
    .config-box, .preview-box, .code-box { background: #fff; border-radius: 8px; padding: 16px; margin-bottom: 20px; }
    h3 { margin-bottom: 16px; font-size: 18px; color: #333; }
    .van-cell { margin-bottom: 8px; }
    /* 预览区样式 */
    .preview-demo { padding: 20px; text-align: center; border: 1px solid #eee; border-radius: 4px; margin-top: 10px; }
    .preview-demo button { padding: 8px 24px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
    /* 代码编辑器高度（避免显示不全） */
    #code-editor { height: 400px; border-radius: 4px; border: 1px solid #eee; }
    /* 按钮组布局 */
    .btn-group { margin-top: 16px; display: flex; gap: 8px; flex-wrap: wrap; }
    .van-button { flex: 1; min-width: 120px; }
    .code-type { margin-bottom: 10px; display: flex; gap: 8px; }
  </style>
</head>
<body>
  <!-- Vue挂载根容器 -->
  <div id="app">
    <!-- 配置区：输入页面标题/按钮文字/颜色 -->
    <div class="config-box">
      <h3>NCNetMobile图形化配置</h3>
      <van-cell-group>
        <!-- 双向绑定配置项：输入值同步到config对象 -->
        <van-field v-model="config.pageTitle" label="页面标题" placeholder="如：我的NCNet应用" clearable />
        <van-field v-model="config.btnText" label="按钮文字" placeholder="如：提交数据" clearable />
        <van-field v-model="config.btnBgColor" label="按钮背景色" placeholder="16进制如：#1677ff" clearable />
        <van-field v-model="config.btnTextColor" label="按钮文字色" placeholder="16进制如：#ffffff" clearable />
      </van-cell-group>
    </div>

    <!-- 预览区：实时展示配置效果 -->
    <div class="preview-box">
      <h3>实时预览（手机端效果）</h3>
      <div class="preview-demo">
        <!-- 标题/按钮显示：无输入时用默认值 -->
        <h4 style="margin-bottom: 20px; font-size: 18px;">{{config.pageTitle || '我的NCNet应用'}}</h4>
        <button :style="{
          background: isValidColor(config.btnBgColor) ? config.btnBgColor : '#1677ff',
          color: isValidColor(config.btnTextColor) ? config.btnTextColor : '#ffffff'
        }">
          {{config.btnText || '提交数据'}}
        </button>
      </div>
    </div>

    <!-- 代码生成区：生成可直接导入安卓项目的代码 -->
    <div class="code-box">
      <h3>生成代码（直接导入NCNetMobile）</h3>
      <!-- 代码类型切换：Java/Kotlin -->
      <div class="code-type">
        <van-radio-group v-model="codeType">
          <van-radio name="java">Java代码</van-radio>
          <van-radio name="kotlin">Kotlin代码</van-radio>
        </van-radio-group>
      </div>
      <!-- 隐藏的文本域：存放生成的代码（用于复制） -->
      <textarea id="code-content" v-model="codeContent" style="display: none;"></textarea>
      <!-- 代码编辑器：可视化展示代码 -->
      <div id="code-editor"></div>
      <div class="btn-group">
        <van-button type="primary" @click="generateCode">一键生成代码</van-button>
        <van-button type="success" data-clipboard-target="#code-content" id="copy-btn">一键复制代码</van-button>
      </div>
    </div>
  </div>

  <script>
    // 解构Vant组件（简化注册）
    const { Field, CellGroup, Button, Toast, RadioGroup, Radio } = vant;
    // 创建Vue实例
    const { createApp } = Vue;
    const app = createApp({
      // 数据区：存放页面交互所需变量
      data() {
        return {
          // 配置项：存储用户输入的标题/按钮/颜色
          config: { pageTitle: "", btnText: "", btnBgColor: "", btnTextColor: "" },
          // 生成的代码内容
          codeContent: "",
          // 代码编辑器实例
          codeEditor: null,
          // 默认生成Kotlin代码（安卓主流）
          codeType: "kotlin"
        };
      },
      // 页面加载完成后执行
      mounted() {
        // 初始化代码编辑器：强制同步默认codeType（优化体验）
        const initMode = this.codeType === "java" ? "text/x-java" : "text/x-kotlin";
        this.codeEditor = CodeMirror(document.getElementById("code-editor"), {
          lineNumbers: true, // 显示行号
          mode: initMode, // 修复初始模式匹配问题
          theme: "default",
          readOnly: false,
          height: "400px"
        });
        
        // 初始化剪贴板：复制成功提示
        new ClipboardJS('#copy-btn').on('success', () => {
          Toast.success('代码复制成功！');
        });
        
        // 页面加载后生成默认代码
        this.generateCode();
        
        // 监听代码类型切换：切换后重新生成对应代码
        this.$watch('codeType', () => {
          this.codeEditor.setOption("mode", this.codeType === "java" ? "text/x-java" : "text/x-kotlin");
          this.generateCode();
        });
      },
      // 方法区：存放页面功能逻辑
      methods: {
        // 校验16进制颜色合法性（支持3位/6位，防止输入无效值）
        isValidColor(hex) {
          if (!hex) return false;
          const reg = /^#([0-9A-Fa-f]{6}|[0-9A-Fa-f]{3})$/;
          return reg.test(hex);
        },
        
        // 16进制颜色转安卓int值（适配安卓代码）
        hexToAndroidColor(hex) {
          if (!this.isValidColor(hex)) hex = "#1677ff"; // 无效值回退默认色
          let color = hex.replace('#', '');
          if (color.length === 3) color = color.split('').map(c => c + c).join('');
          if (color.length === 6) color = 'FF' + color;
          return `0x${color.toUpperCase()}`;
        },
        
        // 核心方法：生成安卓代码
        generateCode() {
          // 获取配置值（无输入时用默认值）
          const pageTitle = this.config.pageTitle || "我的NCNetMobile应用";
          const btnText = this.config.btnText || "提交数据";
          const btnBgColor = this.isValidColor(this.config.btnBgColor) ? this.config.btnBgColor : "#1677ff";
          const btnTextColor = this.isValidColor(this.config.btnTextColor) ? this.config.btnTextColor : "#ffffff";
          
          // 安卓项目包名（⚠️ 需替换为自己的NCNetMobile项目包名）
          const PACKAGE_NAME = "com.ncnetmobile";
          
          // 生成XML布局代码（安卓页面布局）
          const xmlCode = `<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="center"
    android:orientation="vertical"
    android:padding="20dp">

    <TextView
        android:id="@+id/tv_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="${pageTitle}"
        android:textSize="18sp"
        android:textStyle="bold"
        android:marginBottom="30dp"/>

    <Button
        android:id="@+id/btn_submit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="${btnText}"
        android:backgroundTint="${btnBgColor}"
        android:textColor="${btnTextColor}"
        android:padding="10dp 30dp"/>

</LinearLayout>`;

          // 生成Java代码（安卓逻辑）
          const javaCode = `package ${PACKAGE_NAME};

import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        
        // 绑定控件
        TextView tvTitle = findViewById(R.id.tv_title);
        Button btnSubmit = findViewById(R.id.btn_submit);
        
        // 按钮点击事件
        btnSubmit.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Toast.makeText(MainActivity.this, "${btnText}点击成功！", Toast.LENGTH_SHORT).show();
            }
        });
    }
}`;

          // 生成Kotlin代码（安卓主流）
          const kotlinCode = `package ${PACKAGE_NAME}

import android.os.Bundle
import android.widget.Toast
import androidx.appcompat.app.AppCompatActivity
import kotlinx.android.synthetic.main.activity_main.btn_submit
import kotlinx.android.synthetic.main.activity_main.tv_title

class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)
        
        // 按钮点击事件
        btn_submit.setOnClickListener {
            Toast.makeText(this, "${btnText}点击成功！", Toast.LENGTH_SHORT).show()
        }
    }
}`;

          // 组合最终代码：XML+Java/Kotlin
          const finalCode = `=== XML布局文件 (res/layout/activity_main.xml) ===
${xmlCode}

=== ${this.codeType === "java" ? "Java" : "Kotlin"} 代码文件 (${PACKAGE_NAME.replace('.', '/')}/MainActivity.${this.codeType}) ===
${this.codeType === "java" ? javaCode : kotlinCode}`;

          // 更新代码到文本域和编辑器
          this.codeContent = finalCode;
          this.codeEditor.setValue(finalCode);
        }
      }
    });

    // 注册Vant组件
    app.use(Field).use(CellGroup).use(Button).use(Toast).use(RadioGroup).use(Radio);
    // 挂载Vue实例到页面
    app.mount('#app');
  </script>
</body>
</html>

